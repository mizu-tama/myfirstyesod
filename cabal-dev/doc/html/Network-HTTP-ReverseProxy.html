<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Network.HTTP.ReverseProxy</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Network-HTTP-ReverseProxy.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">http-reverse-proxy-0.1.0.7: Reverse proxy HTTP requests, either over raw sockets or with WAI</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Network.HTTP.ReverseProxy</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Types
</a></li><li><a href="#g:2">Raw
</a></li><li><a href="#g:3">WAI + http-conduit
</a></li><li><a href="#g:4">WAI to Raw
</a></li></ul></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span>  <a href="#t:ProxyDest">ProxyDest</a>  = <a href="#v:ProxyDest">ProxyDest</a> {<ul class="subs"><li><a href="#v:pdHost">pdHost</a> :: !<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/CorePrelude.html#t:ByteString">ByteString</a></li><li><a href="#v:pdPort">pdPort</a> :: !<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Int.html#t:Int">Int</a></li></ul>}</li><li class="src short"><a href="#v:rawProxyTo">rawProxyTo</a> :: (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit.html#t:MonadBaseControl">MonadBaseControl</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> m, <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/CorePrelude.html#t:MonadIO">MonadIO</a> m) =&gt; (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-HTTP-Types-Header.html#t:RequestHeaders">RequestHeaders</a> -&gt; m (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a> m) <a href="Network-HTTP-ReverseProxy.html#t:ProxyDest">ProxyDest</a>)) -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a> m</li><li class="src short"><a href="#v:waiProxyTo">waiProxyTo</a> :: (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Request">Request</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Classy.html#t:ResourceT">ResourceT</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Response">Response</a> <a href="Network-HTTP-ReverseProxy.html#t:ProxyDest">ProxyDest</a>)) -&gt; (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a>) -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-HTTP-Conduit.html#t:Manager">Manager</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a></li><li class="src short"><a href="#v:defaultOnExc">defaultOnExc</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a></li><li class="src short"><a href="#v:waiToRaw">waiToRaw</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a></li></ul></div><div id="interface"><h1 id="g:1">Types
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:ProxyDest" class="def">ProxyDest</a>  </p><div class="doc"><p>Host/port combination to which we want to proxy.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ProxyDest" class="def">ProxyDest</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:pdHost" class="def">pdHost</a> :: !<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/CorePrelude.html#t:ByteString">ByteString</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:pdPort" class="def">pdPort</a> :: !<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><h1 id="g:2">Raw
</h1><div class="top"><p class="src"><a name="v:rawProxyTo" class="def">rawProxyTo</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit.html#t:MonadBaseControl">MonadBaseControl</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> m, <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/CorePrelude.html#t:MonadIO">MonadIO</a> m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-HTTP-Types-Header.html#t:RequestHeaders">RequestHeaders</a> -&gt; m (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a> m) <a href="Network-HTTP-ReverseProxy.html#t:ProxyDest">ProxyDest</a>))</td><td class="doc"><p>How to reverse proxy. A <code>Left</code> result will run the given
 <code><a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a></code>, whereas a <code>Right</code> will reverse proxy to the
 given host/port.
</p></td></tr><tr><td class="src">-&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a> m</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Set up a reverse proxy server, which will have a minimal overhead.
</p><p>This function uses raw sockets, parsing as little of the request as
 possible. The workflow is:
</p><ol><li> Parse the first request headers.
</li><li> Ask the supplied function to specify how to reverse proxy.
</li><li> Open up a connection to the given host/port.
</li><li> Pass all bytes across the wire unchanged.
</li></ol><p>If you need more control, such as modifying the request or response, use <code><a href="Network-HTTP-ReverseProxy.html#v:waiProxyTo">waiProxyTo</a></code>.
</p></div></div><h1 id="g:3">WAI + http-conduit
</h1><div class="top"><p class="src"><a name="v:waiProxyTo" class="def">waiProxyTo</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Request">Request</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Classy.html#t:ResourceT">ResourceT</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Response">Response</a> <a href="Network-HTTP-ReverseProxy.html#t:ProxyDest">ProxyDest</a>))</td><td class="doc"><p>How to reverse proxy. A <code>Left</code> result will be sent verbatim as
 the response, whereas <code>Right</code> will cause a reverse proxy.
</p></td></tr><tr><td class="src">-&gt; (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a>)</td><td class="doc"><p>How to handle exceptions when calling remote server. For a
 simple 502 error page, use <code><a href="Network-HTTP-ReverseProxy.html#v:defaultOnExc">defaultOnExc</a></code>.
</p></td></tr><tr><td class="src">-&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-HTTP-Conduit.html#t:Manager">Manager</a></td><td class="doc"><p>connection manager to utilize
</p></td></tr><tr><td class="src">-&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Creates a WAI <code><a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a></code> which will handle reverse proxies.
</p><p>Connections to the proxied server will be provided via http-conduit. As
 such, all requests and responses will be fully processed in your reverse
 proxy. This allows you much more control over the data sent over the wire,
 but also incurs overhead. For a lower-overhead approach, consider
 <code><a href="Network-HTTP-ReverseProxy.html#v:rawProxyTo">rawProxyTo</a></code>.
</p><p>Most likely, the given application should be run with Warp, though in theory
 other WAI handlers will work as well.
</p><p>Note: This function will use chunked request bodies for communicating with
 the proxied server. Not all servers necessarily support chunked request
 bodies, so please confirm that yours does (Warp, Snap, and Happstack, for example, do).
</p></div></div><div class="top"><p class="src"><a name="v:defaultOnExc" class="def">defaultOnExc</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:SomeException">SomeException</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a></p><div class="doc"><p>Sends a simple 502 bad gateway error message with the contents of the
 exception.
</p></div></div><h1 id="g:4">WAI to Raw
</h1><div class="top"><p class="src"><a name="v:waiToRaw" class="def">waiToRaw</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Network-Wai.html#t:Application">Application</a> -&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Conduit-Network.html#t:Application">Application</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a></p><div class="doc"><p>Convert a WAI application into a raw application, using Warp.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.11.0</p></div></body></html>