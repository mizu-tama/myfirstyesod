<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Crypto.Classes</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Crypto-Classes.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">crypto-api-0.10.2: A generic interface for cryptographic operations</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Portability</th><td>portable </td></tr><tr><th>Stability</th><td>beta</td></tr><tr><th>Maintainer</th><td>Thomas.DuBuisson@gmail.com</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Crypto.Classes</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Hash class and helper functions
</a></li><li><a href="#g:2">Cipher classes and helper functions
</a></li><li><a href="#g:3">Misc helper functions
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This is the heart of the crypto-api package.  By making (or having) 
an instance of Hash, AsymCipher, BlockCipher or StreamCipher you provide (or obtain)
access to any infrastructure built on these primitives include block cipher modes
of operation, hashing, hmac, signing, etc.  These classes allow users to build
routines that are agnostic to the algorithm used so changing algorithms is as simple
as changing a type signature.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> d, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> d, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Ord.html#t:Ord">Ord</a> d) =&gt; <a href="#t:Hash">Hash</a> ctx d | d -&gt; ctx, ctx -&gt; d <span class="keyword">where</span><ul class="subs"><li><a href="#v:outputLength">outputLength</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> d <a href="Crypto-Types.html#t:BitLength">BitLength</a></li><li><a href="#v:blockLength">blockLength</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> d <a href="Crypto-Types.html#t:BitLength">BitLength</a></li><li><a href="#v:initialCtx">initialCtx</a> :: ctx</li><li><a href="#v:updateCtx">updateCtx</a> :: ctx -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; ctx</li><li><a href="#v:finalize">finalize</a> :: ctx -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; d</li></ul></li><li class="src short"><a href="#v:hash">hash</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> ctx d =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; d</li><li class="src short"><a href="#v:hash-39-">hash'</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> ctx d =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; d</li><li class="src short"><a href="#v:hashFunc">hashFunc</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> c d =&gt; d -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; d</li><li class="src short"><a href="#v:hashFunc-39-">hashFunc'</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> c d =&gt; d -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; d</li><li class="src short"><span class="keyword">class</span> <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> k =&gt; <a href="#t:BlockCipher">BlockCipher</a> k  <span class="keyword">where</span><ul class="subs"><li><a href="#v:blockSize">blockSize</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:BitLength">BitLength</a></li><li><a href="#v:encryptBlock">encryptBlock</a> :: k -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:decryptBlock">decryptBlock</a> :: k -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:buildKey">buildKey</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> k</li><li><a href="#v:keyLength">keyLength</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:BitLength">BitLength</a></li></ul></li><li class="src short"><a href="#v:blockSizeBytes">blockSizeBytes</a> :: <a href="Crypto-Classes.html#t:BlockCipher">BlockCipher</a> k =&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:ByteLength">ByteLength</a></li><li class="src short"><a href="#v:buildKeyIO">buildKeyIO</a> :: <a href="Crypto-Classes.html#t:BlockCipher">BlockCipher</a> k =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> k</li><li class="src short"><span class="keyword">class</span> <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> k =&gt; <a href="#t:StreamCipher">StreamCipher</a> k iv | k -&gt; iv <span class="keyword">where</span><ul class="subs"><li><a href="#v:buildStreamKey">buildStreamKey</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> k</li><li><a href="#v:encryptStream">encryptStream</a> :: k -&gt; iv -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, iv)</li><li><a href="#v:decryptStream">decryptStream</a> :: k -&gt; iv -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, iv)</li><li><a href="#v:streamKeyLength">streamKeyLength</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:BitLength">BitLength</a></li></ul></li><li class="src short"><a href="#v:buildStreamKeyIO">buildStreamKeyIO</a> :: <a href="Crypto-Classes.html#t:StreamCipher">StreamCipher</a> k iv =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> k</li><li class="src short"><span class="keyword">class</span> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> p, <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> v) =&gt; <a href="#t:AsymCipher">AsymCipher</a> p v | p -&gt; v, v -&gt; p <span class="keyword">where</span><ul class="subs"><li><a href="#v:buildKeyPair">buildKeyPair</a> :: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g =&gt; g -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> ((p, v), g)</li><li><a href="#v:encryptAsym">encryptAsym</a> :: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g =&gt; g -&gt; p -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, g)</li><li><a href="#v:decryptAsym">decryptAsym</a> :: v -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:publicKeyLength">publicKeyLength</a> :: p -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></li><li><a href="#v:privateKeyLength">privateKeyLength</a> :: v -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></li></ul></li><li class="src short"><a href="#v:buildKeyPairIO">buildKeyPairIO</a> :: <a href="Crypto-Classes.html#t:AsymCipher">AsymCipher</a> p v =&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (p, v))</li><li class="src short"><span class="keyword">class</span> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> p, <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> v) =&gt; <a href="#t:Signing">Signing</a> p v | p -&gt; v, v -&gt; p <span class="keyword">where</span><ul class="subs"><li><a href="#v:sign">sign</a> :: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g =&gt; g -&gt; v -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, g)</li><li><a href="#v:verify">verify</a> :: p -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:buildSigningPair">buildSigningPair</a> :: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g =&gt; g -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> ((p, v), g)</li><li><a href="#v:signingKeyLength">signingKeyLength</a> :: v -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></li><li><a href="#v:verifyingKeyLength">verifyingKeyLength</a> :: p -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></li></ul></li><li class="src short"><a href="#v:buildSigningKeyPairIO">buildSigningKeyPairIO</a> :: <a href="Crypto-Classes.html#t:Signing">Signing</a> p v =&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (p, v))</li><li class="src short"><a href="#v:for">for</a> ::  <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> a b -&gt; a -&gt; b</li><li class="src short"><a href="#v:.::.">(.::.)</a> ::  <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> a b -&gt; a -&gt; b</li><li class="src short"><a href="#v:constTimeEq">constTimeEq</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:encode">encode</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> a =&gt; a -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></li></ul></div><div id="interface"><h1 id="g:1">Hash class and helper functions
</h1><div class="top"><p class="src"><span class="keyword">class</span> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> d, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> d, <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Ord.html#t:Ord">Ord</a> d) =&gt; <a name="t:Hash" class="def">Hash</a> ctx d | d -&gt; ctx, ctx -&gt; d <span class="keyword">where</span></p><div class="doc"><p>The Hash class is intended as the generic interface
 targeted by maintainers of Haskell digest implementations.
 Using this generic interface, higher level functions
 such as <code><a href="Crypto-Classes.html#v:hash">hash</a></code> and <code><a href="Crypto-Classes.html#v:hash-39-">hash'</a></code> provide a useful API
 for comsumers of hash implementations.
</p><p>Any instantiated implementation must handle unaligned data
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:outputLength" class="def">outputLength</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> d <a href="Crypto-Types.html#t:BitLength">BitLength</a></td><td class="doc"><p>The size of the digest when encoded
</p></td></tr></table></div><p class="src"><a name="v:blockLength" class="def">blockLength</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> d <a href="Crypto-Types.html#t:BitLength">BitLength</a></td><td class="doc"><p>The amount of data operated on in each round of the digest computation
</p></td></tr></table></div><p class="src"><a name="v:initialCtx" class="def">initialCtx</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: ctx</td><td class="doc"><p>An initial context, provided with the first call to <code><a href="Crypto-Classes.html#v:updateCtx">updateCtx</a></code>
</p></td></tr></table></div><p class="src"><a name="v:updateCtx" class="def">updateCtx</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: ctx</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; ctx</td><td class="doc"><p>Used to update a context, repeatedly called until all data is exhausted
   must operate correctly for imputs of <code>n*blockLength</code> bytes for <code>n <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-List.html#v:elem">elem</a></code> [0..]</code>
</p></td></tr></table></div><p class="src"><a name="v:finalize" class="def">finalize</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: ctx</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; d</td><td class="doc"><p>Finializing a context, plus any message data less than the block size, into a digest
</p></td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:hash" class="def">hash</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> ctx d =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; d</p><div class="doc"><p>Hash a lazy ByteString, creating a digest
</p></div></div><div class="top"><p class="src"><a name="v:hash-39-" class="def">hash'</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> ctx d =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; d</p><div class="doc"><p>Hash a strict ByteString, creating a digest
</p></div></div><div class="top"><p class="src"><a name="v:hashFunc" class="def">hashFunc</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> c d =&gt; d -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; d</p><div class="doc"><p>Obtain a lazy hash function whose result is the same type
 as the given digest, which is discarded.  If the type is already inferred then
 consider using the <code><a href="Crypto-Classes.html#v:hash">hash</a></code> function instead.
</p></div></div><div class="top"><p class="src"><a name="v:hashFunc-39-" class="def">hashFunc'</a> :: <a href="Crypto-Classes.html#t:Hash">Hash</a> c d =&gt; d -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; d</p><div class="doc"><p>Obtain a strict hash function whose result is the same type
 as the given digest, which is discarded.  If the type is already inferred then
 consider using the <code><a href="Crypto-Classes.html#v:hash-39-">hash'</a></code> function instead.
</p></div></div><h1 id="g:2">Cipher classes and helper functions
</h1><div class="top"><p class="src"><span class="keyword">class</span> <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> k =&gt; <a name="t:BlockCipher" class="def">BlockCipher</a> k  <span class="keyword">where</span></p><div class="doc"><p>The BlockCipher class is intended as the generic interface
 targeted by maintainers of Haskell cipher implementations.
 Using this generic interface higher level functions
 such as <code>cbc</code>, and other functions from Data.Crypto.Modes, provide a useful API
 for comsumers of cipher implementations.
</p><p>Instances must handle unaligned data
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:blockSize" class="def">blockSize</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:BitLength">BitLength</a></td><td class="doc"><p>The size of a single block; the smallest unit on which the cipher operates.
</p></td></tr></table></div><p class="src"><a name="v:encryptBlock" class="def">encryptBlock</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: k</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>encrypt data of size <code>n*blockSize</code> where <code>n <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-List.html#v:elem">elem</a></code> [0..]</code>  (ecb encryption)
</p></td></tr></table></div><p class="src"><a name="v:decryptBlock" class="def">decryptBlock</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: k</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>decrypt data of size <code>n*blockSize</code> where <code>n <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-List.html#v:elem">elem</a></code> [0..]</code>  (ecb decryption)
</p></td></tr></table></div><p class="src"><a name="v:buildKey" class="def">buildKey</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> k</td><td class="doc"><p>smart constructor for keys from a bytestring.
</p></td></tr></table></div><p class="src"><a name="v:keyLength" class="def">keyLength</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:BitLength">BitLength</a></td><td class="doc"><p>length of the cryptographic key
</p></td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:blockSizeBytes" class="def">blockSizeBytes</a> :: <a href="Crypto-Classes.html#t:BlockCipher">BlockCipher</a> k =&gt; <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:ByteLength">ByteLength</a></p><div class="doc"><p>The number of bytes in a block cipher block
</p></div></div><div class="top"><p class="src"><a name="v:buildKeyIO" class="def">buildKeyIO</a> :: <a href="Crypto-Classes.html#t:BlockCipher">BlockCipher</a> k =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> k</p><div class="doc"><p>Build a symmetric key using the system entropy (see <code><a href="System-Crypto.html#t:Random">Random</a></code>)
</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> k =&gt; <a name="t:StreamCipher" class="def">StreamCipher</a> k iv | k -&gt; iv <span class="keyword">where</span></p><div class="doc"><p>A stream cipher class.  Instance are expected to work on messages as small as one byte
 The length of the resulting cipher text should be equal
 to the length of the input message.
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:buildStreamKey" class="def">buildStreamKey</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> k</p><p class="src"><a name="v:encryptStream" class="def">encryptStream</a> :: k -&gt; iv -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, iv)</p><p class="src"><a name="v:decryptStream" class="def">decryptStream</a> :: k -&gt; iv -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, iv)</p><p class="src"><a name="v:streamKeyLength" class="def">streamKeyLength</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> k <a href="Crypto-Types.html#t:BitLength">BitLength</a></p></div></div><div class="top"><p class="src"><a name="v:buildStreamKeyIO" class="def">buildStreamKeyIO</a> :: <a href="Crypto-Classes.html#t:StreamCipher">StreamCipher</a> k iv =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> k</p><div class="doc"><p>Build a stream key using the system random generator
</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> p, <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> v) =&gt; <a name="t:AsymCipher" class="def">AsymCipher</a> p v | p -&gt; v, v -&gt; p <span class="keyword">where</span></p><div class="doc"><p>Asymetric ciphers (common ones being RSA or EC based)
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:buildKeyPair" class="def">buildKeyPair</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; g</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> ((p, v), g)</td><td class="doc"><p>build a public/private key pair using the provided generator
</p></td></tr></table></div><p class="src"><a name="v:encryptAsym" class="def">encryptAsym</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; g</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; p</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, g)</td><td class="doc"><p>Asymetric encryption
</p></td></tr></table></div><p class="src"><a name="v:decryptAsym" class="def">decryptAsym</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: v</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Asymetric decryption
</p></td></tr></table></div><p class="src"><a name="v:publicKeyLength" class="def">publicKeyLength</a> :: p -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></p><p class="src"><a name="v:privateKeyLength" class="def">privateKeyLength</a> :: v -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></p></div></div><div class="top"><p class="src"><a name="v:buildKeyPairIO" class="def">buildKeyPairIO</a> :: <a href="Crypto-Classes.html#t:AsymCipher">AsymCipher</a> p v =&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (p, v))</p><div class="doc"><p>Build a pair of asymmetric keys using the system random generator.
</p></div></div><div class="top"><p class="src"><span class="keyword">class</span> (<a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> p, <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> v) =&gt; <a name="t:Signing" class="def">Signing</a> p v | p -&gt; v, v -&gt; p <span class="keyword">where</span></p><div class="doc"><p>A class for signing operations which inherently can not be as generic
 as asymetric ciphers (ex: DSA).
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:sign" class="def">sign</a> :: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g =&gt; g -&gt; v -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a>, g)</p><p class="src"><a name="v:verify" class="def">verify</a> :: p -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a></p><p class="src"><a name="v:buildSigningPair" class="def">buildSigningPair</a> :: <a href="Crypto-Random.html#t:CryptoRandomGen">CryptoRandomGen</a> g =&gt; g -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> ((p, v), g)</p><p class="src"><a name="v:signingKeyLength" class="def">signingKeyLength</a> :: v -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></p><p class="src"><a name="v:verifyingKeyLength" class="def">verifyingKeyLength</a> :: p -&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a></p></div></div><div class="top"><p class="src"><a name="v:buildSigningKeyPairIO" class="def">buildSigningKeyPairIO</a> :: <a href="Crypto-Classes.html#t:Signing">Signing</a> p v =&gt; <a href="Crypto-Types.html#t:BitLength">BitLength</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> <a href="Crypto-Random.html#t:GenError">GenError</a> (p, v))</p><div class="doc"><p>Build a signing key using the system random generator
</p></div></div><h1 id="g:3">Misc helper functions
</h1><div class="top"><p class="src"><a name="v:for" class="def">for</a> ::  <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> a b -&gt; a -&gt; b</p><div class="doc"><p>Obtain a tagged value for a given type
</p></div></div><div class="top"><p class="src"><a name="v:.::." class="def">(.::.)</a> ::  <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Tagged.html#t:Tagged">Tagged</a> a b -&gt; a -&gt; b</p><div class="doc"><p>Infix <code><a href="Crypto-Classes.html#v:for">for</a></code> operator
</p></div></div><div class="top"><p class="src"><a name="v:constTimeEq" class="def">constTimeEq</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Checks two bytestrings for equality without breaches for
 timing attacks.
</p><p>Semantically, <code>constTimeEq = (==)</code>.  However, <code>x == y</code> takes less
 time when the first byte is different than when the first byte
 is equal.  This side channel allows an attacker to mount a
 timing attack.  On the other hand, <code>constTimeEq</code> always takes the
 same time regardless of the bytestrings' contents, unless they are
 of difference size.
</p><p>You should always use <code>constTimeEq</code> when comparing secrets,
 otherwise you may leave a significant security hole
 (cf. <a href="http://codahale.com/a-lesson-in-timing-attacks/">http://codahale.com/a-lesson-in-timing-attacks/</a>).
</p></div></div><div class="top"><p class="src"><a name="v:encode" class="def">encode</a> :: <a href="/Users/mizu_tama/workspace/yesodprojects/myfirstyesod/cabal-dev//doc/html/Data-Serialize.html#t:Serialize">Serialize</a> a =&gt; a -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>Encode a value using binary serialization to a strict ByteString.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.11.0</p></div></body></html>