<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Codec.Archive.Tar</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Codec-Archive-Tar.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">tar-0.4.0.1: Reading, writing and manipulating &quot;.tar&quot; archive files.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Portability</th><td>portable</td></tr><tr><th>Maintainer</th><td>duncan@community.haskell.org</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Codec.Archive.Tar</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">High level &quot;all in one&quot; operations
</a></li><li><a href="#g:2">Notes
</a><ul><li><a href="#g:3">Compressed tar archives
</a></li><li><a href="#g:4">Security
</a></li><li><a href="#g:5">Tarbombs
</a></li></ul></li><li><a href="#g:6">Converting between internal and external representation
</a></li><li><a href="#g:7">Packing and unpacking files to/from internal representation
</a></li><li><a href="#g:8">Types
</a><ul><li><a href="#g:9">Tar entry type
</a></li><li><a href="#g:10">Sequences of tar entries
</a></li></ul></li><li><a href="#g:11">Error handling
</a><ul><li><a href="#g:12">Errors from reading tar files
</a></li></ul></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Reading, writing and manipulating &quot;<code>.tar</code>&quot; archive files.
</p><p>This module uses common names and so is designed to be imported qualified:
</p><pre> import qualified Codec.Archive.Tar as Tar
</pre></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:create">create</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; [<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a>] -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/ghc-prim-0.2.0.0/GHC-Tuple.html#t:-40--41-">()</a></li><li class="src short"><a href="#v:extract">extract</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/ghc-prim-0.2.0.0/GHC-Tuple.html#t:-40--41-">()</a></li><li class="src short"><a href="#v:read">read</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> <a href="Codec-Archive-Tar.html#t:FormatError">FormatError</a></li><li class="src short"><a href="#v:write">write</a> :: [<a href="Codec-Archive-Tar.html#t:Entry">Entry</a>] -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:pack">pack</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; [<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a>] -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> [<a href="Codec-Archive-Tar.html#t:Entry">Entry</a>]</li><li class="src short"><a href="#v:unpack">unpack</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/ghc-prim-0.2.0.0/GHC-Tuple.html#t:-40--41-">()</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Entry">Entry</a> </li><li class="src short"><a href="#v:entryPath">entryPath</a> :: <a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></li><li class="src short"><a href="#v:entryContent">entryContent</a> :: <a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar.html#t:EntryContent">EntryContent</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:EntryContent">EntryContent</a> <ul class="subs"><li>= <a href="#v:NormalFile">NormalFile</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> !<a href="Codec-Archive-Tar-Entry.html#t:FileSize">FileSize</a>  </li><li>| <a href="#v:Directory">Directory</a>  </li><li>| <a href="#v:SymbolicLink">SymbolicLink</a> !<a href="Codec-Archive-Tar-Entry.html#t:LinkTarget">LinkTarget</a>  </li><li>| <a href="#v:HardLink">HardLink</a> !<a href="Codec-Archive-Tar-Entry.html#t:LinkTarget">LinkTarget</a>  </li><li>| <a href="#v:CharacterDevice">CharacterDevice</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMajor">DevMajor</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMinor">DevMinor</a>  </li><li>| <a href="#v:BlockDevice">BlockDevice</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMajor">DevMajor</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMinor">DevMinor</a>  </li><li>| <a href="#v:NamedPipe">NamedPipe</a>  </li><li>| <a href="#v:OtherEntryType">OtherEntryType</a> !<a href="Codec-Archive-Tar-Entry.html#t:TypeCode">TypeCode</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> !<a href="Codec-Archive-Tar-Entry.html#t:FileSize">FileSize</a>  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Entries">Entries</a> e<ul class="subs"><li>= <a href="#v:Next">Next</a> <a href="Codec-Archive-Tar.html#t:Entry">Entry</a> (<a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e)  </li><li>| <a href="#v:Done">Done</a>  </li><li>| <a href="#v:Fail">Fail</a> e  </li></ul></li><li class="src short"><a href="#v:mapEntries">mapEntries</a> ::  (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> e' <a href="Codec-Archive-Tar.html#t:Entry">Entry</a>) -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> e e')</li><li class="src short"><a href="#v:mapEntriesNoFail">mapEntriesNoFail</a> ::  (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar.html#t:Entry">Entry</a>) -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e</li><li class="src short"><a href="#v:foldEntries">foldEntries</a> ::  (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; a -&gt; a) -&gt; a -&gt; (e -&gt; a) -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; a</li><li class="src short"><a href="#v:unfoldEntries">unfoldEntries</a> ::  (a -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> e (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a>, a))) -&gt; a -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e</li><li class="src short"><span class="keyword">data</span>  <a href="#t:FormatError">FormatError</a> <ul class="subs"><li>= <a href="#v:TruncatedArchive">TruncatedArchive</a>  </li><li>| <a href="#v:ShortTrailer">ShortTrailer</a>  </li><li>| <a href="#v:BadTrailer">BadTrailer</a>  </li><li>| <a href="#v:TrailingJunk">TrailingJunk</a>  </li><li>| <a href="#v:ChecksumIncorrect">ChecksumIncorrect</a>  </li><li>| <a href="#v:NotTarFormat">NotTarFormat</a>  </li><li>| <a href="#v:UnrecognisedTarFormat">UnrecognisedTarFormat</a>  </li><li>| <a href="#v:HeaderBadNumericEncoding">HeaderBadNumericEncoding</a>  </li></ul></li></ul></div><div id="interface"><h1>Documentation</h1><div class="doc"><p>Tar archive files are used to store a collection of other files in a
 single file. They consists of a sequence of entries. Each entry describes
 a file or directory (or some other special kind of file). The entry stores
 a little bit of meta-data, in particular the file or directory name.
</p><p>Unlike some other archive formats, a tar file contains no index. The
 information about each entry is stored next to the entry. Because of this,
 tar files are almost always processed linearly rather than in a
 random-access fashion.
</p><p>The functions in this package are designed for working on tar files
 linearly and lazily. This makes it possible to do many operations in
 constant space rather than having to load the entire archive into memory.
</p><p>It can read and write standard POSIX tar files and also the GNU and old
 Unix V7 tar formats. The convenience functions that are provided in the
 <a href="Codec-Archive-Tar-Entry.html">Codec.Archive.Tar.Entry</a> module for creating archive entries are
 primarily designed for standard portable archives. If you need to
 construct GNU format archives or exactly preserve file ownership and
 permissions then you will need to write some extra helper functions.
</p><p>This module contains just the simple high level operations without
 exposing the all the details of tar files. If you need to inspect tar
 entries in more detail or construct them directly then you also need
 the module <a href="Codec-Archive-Tar-Entry.html">Codec.Archive.Tar.Entry</a>.
</p></div><h1 id="g:1">High level &quot;all in one&quot; operations
</h1><div class="top"><p class="src"><a name="v:create" class="def">create</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></td><td class="doc"><p>Path of the &quot;.tar&quot; file to write.
</p></td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></td><td class="doc"><p>Base directory
</p></td></tr><tr><td class="src">-&gt; [<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a>]</td><td class="doc"><p>Files and directories to archive, relative to base dir
</p></td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/ghc-prim-0.2.0.0/GHC-Tuple.html#t:-40--41-">()</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create a new <code>&quot;.tar&quot;</code> file from a directory of files.
</p><p>It is equivalent to calling the standard <code>tar</code> program like so:
</p><pre>$ tar -f tarball.tar -C base -c dir</pre><p>This assumes a directory <code>./base/dir</code> with files inside, eg
 <code>./base/dir/foo.txt</code>. The file names inside the resulting tar file will be
 relative to <code>dir</code>, eg <code>dir/foo.txt</code>.
</p><p>This is a high level &quot;all in one&quot; operation. Since you may need variations
 on this function it is instructive to see how it is written. It is just:
</p><pre> BS.writeFile tar . Tar.write =&lt;&lt; Tar.pack base paths
</pre><p>Notes:
</p><p>The files and directories must not change during this operation or the
 result is not well defined.
</p><p>The intention of this function is to create tarballs that are portable
 between systems. It is <em>not</em> suitable for doing file system backups because
 file ownership and permissions are not fully preserved. File ownership is
 not preserved at all. File permissions are set to simple portable values:
</p><ul><li> <code>rw-r--r--</code> for normal files
</li><li> <code>rwxr-xr-x</code> for executable files
</li><li> <code>rwxr-xr-x</code> for directories
</li></ul></div></div><div class="top"><p class="src"><a name="v:extract" class="def">extract</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></td><td class="doc"><p>Destination directory
</p></td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></td><td class="doc"><p>Tarball
</p></td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/ghc-prim-0.2.0.0/GHC-Tuple.html#t:-40--41-">()</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Extract all the files contained in a <code>&quot;.tar&quot;</code> file.
</p><p>It is equivalent to calling the standard <code>tar</code> program like so:
</p><pre>$ tar -x -f tarball.tar -C dir</pre><p>So for example if the <code>tarball.tar</code> file contains <code>foo/bar.txt</code> then this
 will extract it to <code>dir/foo/bar.txt</code>.
</p><p>This is a high level &quot;all in one&quot; operation. Since you may need variations
 on this function it is instructive to see how it is written. It is just:
</p><pre> Tar.unpack dir . Tar.read =&lt;&lt; BS.readFile tar
</pre><p>Notes:
</p><p>Extracting can fail for a number of reasons. The tarball may be incorrectly
 formatted. There may be IO or permission errors. In such cases an exception
 will be thrown and extraction will not continue.
</p><p>Since the extraction may fail part way through it is not atomic. For this
 reason you may want to extract into an empty directory and, if the
 extraction fails, recursively delete the directory.
</p><p>Security: only files inside the target directory will be written. Tarballs
 containing entries that point outside of the tarball (either absolute paths
 or relative paths) will be caught and an exception will be thrown.
</p></div></div><h1 id="g:2">Notes
</h1><h2 id="g:3">Compressed tar archives
</h2><div class="doc"><p>Tar files are commonly used in conjunction with gzip compression, as in
 &quot;<code>.tar.gz</code>&quot; or &quot;<code>.tar.bz2</code>&quot; files. This module does not directly
 handle compressed tar files however they can be handled easily by
 composing functions from this module and the modules
 <code>Codec.Compression.GZip</code> or <code>Codec.Compression.BZip</code>
 (see <code>zlib</code> or <code>bzlib</code> packages).
</p><p>Creating a compressed &quot;<code>.tar.gz</code>&quot; file is just a minor variation on the
 <code><a href="Codec-Archive-Tar.html#v:create">create</a></code> function, but where throw compression into the pipeline:
</p><pre> BS.writeFile tar . GZip.compress . Tar.write =&lt;&lt; Tar.pack base dir
</pre><p>Similarly, extracting a compressed &quot;<code>.tar.gz</code>&quot; is just a minor variation
 on the <code><a href="Codec-Archive-Tar.html#v:extract">extract</a></code> function where we use decompression in the pipeline:
</p><pre> Tar.unpack dir . Tar.read . GZip.decompress =&lt;&lt; BS.readFile tar
</pre></div><h2 id="g:4">Security
</h2><div class="doc"><p>This is pretty important. A maliciously constructed tar archives could
 contain entries that specify bad file names. It could specify absolute
 file names like &quot;<code>/etc/passwd</code>&quot; or relative files outside of the
 archive like &quot;../../../something&quot;. This security problem is commonly
 called a &quot;directory traversal vulnerability&quot;. Historically, such
 vulnerabilities have been common in packages handling tar archives.
</p><p>The <code><a href="Codec-Archive-Tar.html#v:extract">extract</a></code> and <code><a href="Codec-Archive-Tar.html#v:unpack">unpack</a></code> functions check for bad file names. See the
 <code><a href="Codec-Archive-Tar-Check.html#v:checkSecurity">checkSecurity</a></code> function for more details. If you need to do any custom
 unpacking then you should use this.
</p></div><h2 id="g:5">Tarbombs
</h2><div class="doc"><p>A &quot;tarbomb&quot; is a <code>.tar</code> file where not all entries are in a
 subdirectory but instead files extract into the top level directory. The
 <code><a href="Codec-Archive-Tar.html#v:extract">extract</a></code> function does not check for these however if you want to do
 that you can use the <code><a href="Codec-Archive-Tar-Check.html#v:checkTarbomb">checkTarbomb</a></code> function like so:
</p><pre> Tar.unpack dir . Tar.checkTarbomb expectedDir
                . Tar.read =&lt;&lt; BS.readFile tar
</pre><p>In this case extraction will fail if any file is outside of <code>expectedDir</code>.
</p></div><h1 id="g:6">Converting between internal and external representation
</h1><div class="doc"><p>Note, you cannot expect <code>write . read</code> to give exactly the same output
 as input. You can expect the information to be preserved exactly however.
 This is because <code><a href="Codec-Archive-Tar.html#v:read">read</a></code> accepts common format variations while <code><a href="Codec-Archive-Tar.html#v:write">write</a></code>
 produces the standard format.
</p></div><div class="top"><p class="src"><a name="v:read" class="def">read</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> <a href="Codec-Archive-Tar.html#t:FormatError">FormatError</a></p><div class="doc"><p>Convert a data stream in the tar file format into an internal data
 structure. Decoding errors are reported by the <code><a href="Codec-Archive-Tar.html#v:Fail">Fail</a></code> constructor of the
 <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code> type.
</p><ul><li> The conversion is done lazily.
</li></ul></div></div><div class="top"><p class="src"><a name="v:write" class="def">write</a> :: [<a href="Codec-Archive-Tar.html#t:Entry">Entry</a>] -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></p><div class="doc"><p>Create the external representation of a tar archive by serialising a list
 of tar entries.
</p><ul><li> The conversion is done lazily.
</li></ul></div></div><h1 id="g:7">Packing and unpacking files to/from internal representation
</h1><div class="doc"><p>These functions are for packing and unpacking portable archives. They
 are not suitable in cases where it is important to preserve file ownership
 and permissions or to archive special files like named pipes and Unix
 device files.
</p></div><div class="top"><p class="src"><a name="v:pack" class="def">pack</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></td><td class="doc"><p>Base directory
</p></td></tr><tr><td class="src">-&gt; [<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a>]</td><td class="doc"><p>Files and directories to pack, relative to the base dir
</p></td></tr><tr><td class="src">-&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> [<a href="Codec-Archive-Tar.html#t:Entry">Entry</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Creates a tar archive from a list of directory or files. Any directories
 specified will have their contents included recursively. Paths in the
 archive will be relative to the given base directory.
</p><p>This is a portable implementation of packing suitable for portable archives.
 In particular it only constructs <code><a href="Codec-Archive-Tar.html#v:NormalFile">NormalFile</a></code> and <code><a href="Codec-Archive-Tar.html#v:Directory">Directory</a></code> entries. Hard
 links and symbolic links are treated like ordinary files. It cannot be used
 to pack directories containing recursive symbolic links. Special files like
 FIFOs (named pipes), sockets or device files will also cause problems.
</p><p>An exception will be thrown for any file names that are too long to
 represent as a <code><a href="Codec-Archive-Tar-Entry.html#t:TarPath">TarPath</a></code>.
</p><ul><li> This function returns results lazily. Subdirectories are scanned
 and files are read one by one as the list of entries is consumed.
</li></ul></div></div><div class="top"><p class="src"><a name="v:unpack" class="def">unpack</a> :: <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a> -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:IO">IO</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/ghc-prim-0.2.0.0/GHC-Tuple.html#t:-40--41-">()</a></p><div class="doc"><p>Create local files and directories based on the entries of a tar archive.
</p><p>This is a portable implementation of unpacking suitable for portable
 archives. It handles <code><a href="Codec-Archive-Tar.html#v:NormalFile">NormalFile</a></code> and <code><a href="Codec-Archive-Tar.html#v:Directory">Directory</a></code> entries and has simulated
 support for <code><a href="Codec-Archive-Tar.html#v:SymbolicLink">SymbolicLink</a></code> and <code><a href="Codec-Archive-Tar.html#v:HardLink">HardLink</a></code> entries. Links are implemented by
 copying the target file. This therefore works on Windows as well as Unix.
 All other entry types are ignored, that is they are not unpacked and no
 exception is raised.
</p><p>If the <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code> ends in an error then it is raised an an exception. Any
 files or directories that have been unpacked before the error was
 encountered will not be deleted. For this reason you may want to unpack
 into an empty directory so that you can easily clean up if unpacking fails
 part-way.
</p><p>On its own, this function only checks for security (using <code><a href="Codec-Archive-Tar-Check.html#v:checkSecurity">checkSecurity</a></code>).
 You can do other checks by applying checking functions to the <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code> that
 you pass to this function. For example:
</p><pre> unpack dir (checkTarbomb expectedDir entries)
</pre><p>If you care about the priority of the reported errors then you may want to
 use <code><a href="Codec-Archive-Tar-Check.html#v:checkSecurity">checkSecurity</a></code> before <code><a href="Codec-Archive-Tar-Check.html#v:checkTarbomb">checkTarbomb</a></code> or other checks.
</p></div></div><h1 id="g:8">Types
</h1><h2 id="g:9">Tar entry type
</h2><div class="doc"><p>This module provides only very simple and limited read-only access to
 the <code><a href="Codec-Archive-Tar.html#t:Entry">Entry</a></code> type. If you need access to the details or if you need to
 construct your own entries then also import <a href="Codec-Archive-Tar-Entry.html">Codec.Archive.Tar.Entry</a>.
</p></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Entry" class="def">Entry</a>  </p><div class="doc"><p>Tar archive entry.
</p></div></div><div class="top"><p class="src"><a name="v:entryPath" class="def">entryPath</a> :: <a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></p><div class="doc"><p>Native <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO.html#t:FilePath">FilePath</a></code> of the file or directory within the archive.
</p></div></div><div class="top"><p class="src"><a name="v:entryContent" class="def">entryContent</a> :: <a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar.html#t:EntryContent">EntryContent</a></p><div class="doc"><p>The real content of the entry. For <code><a href="Codec-Archive-Tar.html#v:NormalFile">NormalFile</a></code> this includes the
 file data. An entry usually contains a <code><a href="Codec-Archive-Tar.html#v:NormalFile">NormalFile</a></code> or a <code><a href="Codec-Archive-Tar.html#v:Directory">Directory</a></code>.
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:EntryContent" class="def">EntryContent</a>  </p><div class="doc"><p>The content of a tar archive entry, which depends on the type of entry.
</p><p>Portable archives should contain only <code><a href="Codec-Archive-Tar.html#v:NormalFile">NormalFile</a></code> and <code><a href="Codec-Archive-Tar.html#v:Directory">Directory</a></code>.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:NormalFile" class="def">NormalFile</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> !<a href="Codec-Archive-Tar-Entry.html#t:FileSize">FileSize</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Directory" class="def">Directory</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:SymbolicLink" class="def">SymbolicLink</a> !<a href="Codec-Archive-Tar-Entry.html#t:LinkTarget">LinkTarget</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:HardLink" class="def">HardLink</a> !<a href="Codec-Archive-Tar-Entry.html#t:LinkTarget">LinkTarget</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:CharacterDevice" class="def">CharacterDevice</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMajor">DevMajor</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMinor">DevMinor</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:BlockDevice" class="def">BlockDevice</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMajor">DevMajor</a> !<a href="Codec-Archive-Tar-Entry.html#t:DevMinor">DevMinor</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NamedPipe" class="def">NamedPipe</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OtherEntryType" class="def">OtherEntryType</a> !<a href="Codec-Archive-Tar-Entry.html#t:TypeCode">TypeCode</a> <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a> !<a href="Codec-Archive-Tar-Entry.html#t:FileSize">FileSize</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:EntryContent" class="caption collapser" onclick="toggleSection('i:EntryContent')">Instances</p><div id="section.i:EntryContent" class="show"><table><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Eq.html#t:Eq">Eq</a> <a href="Codec-Archive-Tar.html#t:EntryContent">EntryContent</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Ord.html#t:Ord">Ord</a> <a href="Codec-Archive-Tar.html#t:EntryContent">EntryContent</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h2 id="g:10">Sequences of tar entries
</h2><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Entries" class="def">Entries</a> e </p><div class="doc"><p>A tar archive is a sequence of entries.
</p><p>The point of this type as opposed to just using a list is that it makes the
 failure case explicit. We need this because the sequence of entries we get
 from reading a tarball can include errors.
</p><p>It is a concrete data type so you can manipulate it directly but it is often
 clearer to use the provided functions for mapping, folding and unfolding.
</p><p>Converting from a list can be done with just <code>foldr Next Done</code>. Converting
 back into a list can be done with <code><a href="Codec-Archive-Tar.html#v:foldEntries">foldEntries</a></code> however in that case you
 must be prepared to handle the <code><a href="Codec-Archive-Tar.html#v:Fail">Fail</a></code> case inherent in the <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code> type.
</p><p>The <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Monoid.html#t:Monoid">Monoid</a></code> instance lets you concatenate archives or append entries to an
 archive.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Next" class="def">Next</a> <a href="Codec-Archive-Tar.html#t:Entry">Entry</a> (<a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Done" class="def">Done</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Fail" class="def">Fail</a> e</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Entries" class="caption collapser" onclick="toggleSection('i:Entries')">Instances</p><div id="section.i:Entries" class="show"><table><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Monoid.html#t:Monoid">Monoid</a> (<a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:mapEntries" class="def">mapEntries</a> ::  (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> e' <a href="Codec-Archive-Tar.html#t:Entry">Entry</a>) -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> e e')</p><div class="doc"><p>This is like the standard <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-List.html#v:map">map</a></code> function on lists, but for <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code>. It
 includes failure as a extra possible outcome of the mapping function.
</p><p>If your mapping function cannot fail it may be more convenient to use
 <code><a href="Codec-Archive-Tar.html#v:mapEntriesNoFail">mapEntriesNoFail</a></code>
</p></div></div><div class="top"><p class="src"><a name="v:mapEntriesNoFail" class="def">mapEntriesNoFail</a> ::  (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; <a href="Codec-Archive-Tar.html#t:Entry">Entry</a>) -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e</p><div class="doc"><p>Like <code><a href="Codec-Archive-Tar.html#v:mapEntries">mapEntries</a></code> but the mapping function itself cannot fail.
</p></div></div><div class="top"><p class="src"><a name="v:foldEntries" class="def">foldEntries</a> ::  (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a> -&gt; a -&gt; a) -&gt; a -&gt; (e -&gt; a) -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e -&gt; a</p><div class="doc"><p>This is like the standard <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-List.html#v:foldr">foldr</a></code> function on lists, but for <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code>.
 Compared to <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-List.html#v:foldr">foldr</a></code> it takes an extra function to account for the
 possibility of failure.
</p><p>This is used to consume a sequence of entries. For example it could be used
 to scan a tarball for problems or to collect an index of the contents.
</p></div></div><div class="top"><p class="src"><a name="v:unfoldEntries" class="def">unfoldEntries</a> ::  (a -&gt; <a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Either.html#t:Either">Either</a> e (<a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Codec-Archive-Tar.html#t:Entry">Entry</a>, a))) -&gt; a -&gt; <a href="Codec-Archive-Tar.html#t:Entries">Entries</a> e</p><div class="doc"><p>This is like the standard <code>unfoldr</code> function on lists, but for <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code>.
 It includes failure as an extra possibility that the stepper function may
 return.
</p><p>It can be used to generate <code><a href="Codec-Archive-Tar.html#t:Entries">Entries</a></code> from some other type. For example it is
 used internally to lazily unfold entries from a <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/bytestring-0.9.2.1/Data-ByteString-Lazy.html#t:ByteString">ByteString</a></code>.
</p></div></div><h1 id="g:11">Error handling
</h1><div class="doc"><p>Reading tar files can fail if the data does not match the tar file
 format correctly.
</p><p>The style of error handling by returning structured errors. The pure
 functions in the library do not throw exceptions, they return the errors
 as data. The IO actions in the library can throw exceptions, in particular
 the <code><a href="Codec-Archive-Tar.html#v:unpack">unpack</a></code> action does this. All the error types used are an instance of
 the standard <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:Exception">Exception</a></code> class so it is possible to <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#v:throw">throw</a></code> and <code><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/System-IO-Error.html#v:catch">catch</a></code>
 them.
</p></div><h2 id="g:12">Errors from reading tar files
</h2><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:FormatError" class="def">FormatError</a>  </p><div class="doc"><p>Errors that can be encountered when parsing a Tar archive.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:TruncatedArchive" class="def">TruncatedArchive</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ShortTrailer" class="def">ShortTrailer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:BadTrailer" class="def">BadTrailer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:TrailingJunk" class="def">TrailingJunk</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:ChecksumIncorrect" class="def">ChecksumIncorrect</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:NotTarFormat" class="def">NotTarFormat</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:UnrecognisedTarFormat" class="def">UnrecognisedTarFormat</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:HeaderBadNumericEncoding" class="def">HeaderBadNumericEncoding</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:FormatError" class="caption collapser" onclick="toggleSection('i:FormatError')">Instances</p><div id="section.i:FormatError" class="show"><table><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Text-Show.html#t:Show">Show</a> <a href="Codec-Archive-Tar.html#t:FormatError">FormatError</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Data-Typeable-Internal.html#t:Typeable">Typeable</a> <a href="Codec-Archive-Tar.html#t:FormatError">FormatError</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="/Library/Frameworks/GHC.framework/Versions/7.4.2-i386/usr/share/doc/ghc/html/libraries/base-4.5.1.0/Control-Exception-Base.html#t:Exception">Exception</a> <a href="Codec-Archive-Tar.html#t:FormatError">FormatError</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.11.0</p></div></body></html>